# Fluent Bit config for monitoring-frontend sidecar: tail nginx logs â†’ Kafka
apiVersion: v1
kind: ConfigMap
metadata:
  name: fluent-bit-frontend-config
  namespace: apps
data:
  fluent-bit.conf: |
    [SERVICE]
        Flush         1
        Log_Level     info

    [INPUT]
        Name          tail
        Path          /var/log/nginx/access.log
        Path          /var/log/nginx/error.log
        Read_from_Head true
        Tag           nginx
        Refresh_Interval 5

    [FILTER]
        Name          modify
        Match         *
        Add           source monitoring-frontend

    [OUTPUT]
        Name          kafka
        Match         *
        Brokers       cluster-kafka-bootstrap.kafka.svc.cluster.local:9092
        Topics        monitoring-logs
        Format        json_stream
